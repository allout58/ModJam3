1.7 - Straight(ish) port of v0.0.4 from 1.6